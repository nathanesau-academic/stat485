theta = model2.theta), 0.01, 10000,
ylab = "F(x)", xlab = "x", col = 'blue')
plot(function(x) pigamma(x, alpha = model2.alpha,
theta = model2.theta), 0.01, 10000,
ylab = "F(x)", xlab = "x", col = 'blue')
plot(pemp, 0, 10000, type = 's')
plot(function(x) pigamma(x, alpha = model2.alpha,
theta = model2.theta), 0.01, 10000,
ylab = "F(x)", xlab = "x", col = 'blue', add=TRUE)
plot(pemp, 0, 10000, type = 's', ylab = "F(x)", xlab = "x")
plot(function(x) pigamma(x, alpha = model2.alpha,
theta = model2.theta), 0.01, 10000,
col = 'blue', add=TRUE)
plot(pemp, 0.01, 10000, type = 's', ylab = "F(x)", xlab = "x")
plot(pemp, 0.01, 10000, type = 's', ylab = "F(x)", xlab = "x")
plot(function(x) pigamma(x, alpha = model2.alpha,
theta = model2.theta), 0.01, 10000,
col = 'blue', add=TRUE)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
plot(function(x) D(x, alpha, model1.alpha,
theta = model1.theta), 0.01, 10000)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
plot(function(x) D(x, alpha = model1.alpha,
theta = model1.theta), 0.01, 10000, col = 'red')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
em
emp
model
emp <- pemp(x)
model1 <- pigamma(x, alpha = model1.alpha, theta = model1.theta)
model2 <- pigamma(x, alpha = model2.alpha, theta = model2.theta)
model1
model2.alpha
plot(x = model1, y = emp)
emp
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
emp <- pemp(x)
em
emp
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
qemp(5)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
qemp(1000)
qemp(0.5)
pemp(0.5)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
qemp(1000)
qemp(0.5)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
qemp(1000)
qemp(0.5_)
qemp(0.5)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
qemp(0.5)
qemp(0.05)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
qemp(0.05)
qemp(0.1)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
qemp(0.05)
x
qemp(0.05)
qemp(0.05)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
model1
plot(x = model1, y = emp)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
abline(lm(model1 ~ emp))
plot(x = model2, y = emp, ylim = c(0, 1))
abline(lm(model2 ~ emp))
plot(x = model2, y = emp, ylim = c(0, 1))
abline(lm(model2 ~ emp), col = 'blue')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
lines(function(x) x, 0, 1)
plot(x = model2, y = emp, ylim = c(0, 1))
lines(function(x) x, 0, 1)
plot(function(x) x, 0, 1)
plot(x = model2, y = emp, ylim = c(0, 1))
plot(function(x) x, 0, 1, add=TRUE)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
tail(model2,1)
model2.alpha
model2.theta
x
pigamma(15743, alpha = model2.alpha, theta = model2.theta)
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
plot(function(x) x, 0, 1, add=TRUE, col = 'blue')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
legend('topleft', c("Model 1"))
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
?pin
?par
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
source('C:/Users/nesau/Dropbox/SFU/1167/Acma395/Assignments/Assignment6/R/question3.R')
?PAR
?par
source('C:/Users/nesau/Desktop/test.R')
source('C:/Users/nesau/Desktop/test.R')
ad.model1
ad.model2
y <- c(d, unique(x))
d = 0
y <- c(d, unique(x))
n <- length(y) - 1
Fe <- ecdf(x)
Fm <- function(x) (Fmcdf(x) - Fmcdf(d))/(1 - Fmcdf(d))
term1 = -n # u = Inf
yj1 <- y[1:(n-1+1)]
yj2 <- y[2:(n+1)]
term2 = n * sum((1-Fe(yj1))^2 * (log(1 - Fm(yj1)) - log(1 - Fm(yj2))))
Fmcdf = function(y) pigamma(y, alpha = model1.alpha,
theta = model1.theta)
y <- c(d, unique(x))
n <- length(y) - 1
Fe <- ecdf(x)
Fm <- function(x) (Fmcdf(x) - Fmcdf(d))/(1 - Fmcdf(d))
term1 = -n # u = Inf
yj1 <- y[1:(n-1+1)]
yj2 <- y[2:(n+1)]
term2 = n * sum((1-Fe(yj1))^2 * (log(1 - Fm(yj1)) - log(1 - Fm(yj2))))
yj1 <- y[2:(n-1+1)]
yj2 <- y[3:(n+1)]
term3 = n * (sum(Fe(yj1)^2 * (log(Fm(yj2)) - log(Fm(yj1)))) -
log(Fm(tail(y,1)))) # for last term, u = Inf
term1 + term2 + term3
tterm1
term1
term1 = -n * Fm(15743)
source('C:/Users/nesau/Desktop/test.R')
term2
term2 = (1-Fe(yj1))^2 * (log(1 - Fm(yj1)) - log(1 - Fm(yj2)))
term2
sum(term2)
Fe(yj1)
Fm(yj1)
Fmcdf = function(y) pigamma(y, alpha = model2.alpha,
theta = model2.theta)
source('C:/Users/nesau/Desktop/test.R')
term1 + term2 + term3
term2 = -n * sum (1-Fe(yj1))^2 * (log(1 - Fm(yj1)) - log(1 - Fm(yj2)))
source('C:/Users/nesau/Desktop/test.R')
term2
source('C:/Users/nesau/Desktop/test.R')
source('C:/Users/nesau/Desktop/test.R')
term1 + term2 + term3
source('C:/Users/nesau/Desktop/test.R')
term1 + term2 + term3
term2 = (1-Fe(yj1))^2 * (log(1 - Fm(yj1)) - log(1 - Fm(yj2)))
term2
yj1 <- y[1:(n-1+1)]
yj2 <- y[2:(n+1)]
term2 = (1-Fe(yj1))^2 * (log(1 - Fm(yj1)) - log(1 - Fm(yj2)))
term2
y <- c(d, unique(x))
n <- length(y) - 1
Fe <- ecdf(x)
Fm <- function(x) (Fmcdf(x) - Fmcdf(d))/(1 - Fmcdf(d))
term1 = -n
yj1 <- y[1:(n-1+1)]
yj2 <- y[2:(n+1)]
term2 = (1-Fe(yj1))^2 * (log(1 - Fm(yj1)) - log(1 - Fm(yj2)))
term2
Fm(yj1)
theta <- 0.5
Y0 <- 0
theta <- 0.5
y <- numeric(100)
for(t in 1:100) {
}
if(t == 1) y[t] <- rnorm(1) # y[0] = 0
for(t in 1:100) {
if(t == 1) { # e[0] = 0
y[t] <- e[1] # y[1] = e[1]
}
else {
y[t] <- e[t] - theta * e[t-1] # y[t] = e[t] - e[t-1] * theta
}
}
source('C:/Users/nesau/Desktop/residuals.R')
plot(y)
plot(y, type = 'l')
?arima
theta <- 0.5
n <- 500
y <- numeric(n)
e <- rnorm(n)
for(t in 1:n) {
if(t == 1) { # e[0] = 0
y[t] <- e[1] # y[1] = e[1]
}
else {
y[t] <- e[t] - theta * e[t-1] # y[t] = e[t] - e[t-1] * theta
}
}
plot(y, type = 'l')
arima(y, order = c(0, 0, 1), include.mean=FALSE)
arima(y, order = c(0, 0, 1))
arima(y, order = c(0, 0, 1), include.mean=FALSE)
set.seed(100)
theta <- 0.5
n <- 500
y <- numeric(n)
e <- rnorm(n)
for(t in 1:n) {
if(t == 1) { # e[0] = 0
y[t] <- e[1] # y[1] = e[1]
}
else {
y[t] <- e[t] - theta * e[t-1] # y[t] = e[t] - e[t-1] * theta
}
}
plot(y, type = 'l')
arima(y, order = c(0, 0, 1), include.mean=FALSE)
model <- arima(y, order = c(0, 0, 1), include.mean=FALSE)
model$resi
res <- head(model$residuals, 6)
res
y[1]
model
y[1]
?arima
model <- arima(y, order = c(0, 0, 1))
model
head(model$residuals)
source('C:/Users/nesau/Desktop/residuals.R')
source('C:/Users/nesau/Desktop/residuals.R')
source('C:/Users/nesau/Desktop/residuals.R')
source('C:/Users/nesau/Desktop/residuals.R')
source('C:/Users/nesau/Desktop/residuals.R')
reas
res
e[1]
y[1]
y[2]
model
theta <- 0.5955
theta
theta * y[1]
ey[2]
y[2]
(1-theta)
res
(1-theta)*theta
(1-theta)*theta^2
j <- 1:500
pi <- (1-theta)*theta^(j)
pi
pi <- (1-theta)*theta^(j-1)
y[1] * pi[1]
y[2] - y[1] * pi[1]
y[1] * pi[1] y[2]
y[1] * pi[1] - y[2]
1 - (y[1] * pi[1] - y[2])
y[1] * pi[1] - y[2] + 1
res
y1 <- round(y[1:5], 2)
y1
r1 <- TSA::acf(y1)
r1
r1 <- TSA::acf(y1, plot = FALSE)
r1
r1 <- TSA::acf(y1, plot = FALSE)$acf
r1
r1 <- TSA::acf(y1, plot = FALSE)$acf[,,1]
r1 <- acf(y1, plot = FALSE)$acf[,,1]
r1
r1 <- acf(y1, plot = FALSE)$acf
r1
r1 <- TSA::acf(y1, plot = FALSE)$acf[,,1]
r1
theta <- (-1 + sqrt(1-4*r1^2)) / (2*r1)
y1 <- round(y[1:5], 2)
r1 <- TSA::acf(y1, plot = FALSE)$acf[,,1]
theta <- (-1 + sqrt(1-4*r1^2)) / (2*r1)
source('C:/Users/nesau/Desktop/residuals.R')
source('C:/Users/nesau/Desktop/residuals.R')
r1
r1 <- TSA::acf(y1, plot = FALSE)$acf[1]
r1
theta <- (-1 + sqrt(1-4*r1^2)) / (2*r1)
source('C:/Users/nesau/Desktop/residuals.R')
theta
arima(y1, order = c(0,0,1))
arima(y1, order = c(0,0,1),include.mean=FALSE)
arima(y1, order = c(0,0,1), include.mean=FALSE)
y1
r1
theta
model <- arima(y, order = c(1, 0, 0), include.mean=FALSE)
source('C:/Users/nesau/Desktop/residuals.R')
source('C:/Users/nesau/Desktop/residuals.R')
model
model$residuals
y[1]
head(residuals)
head(model$residuals
)
model
phi <- -0.4029
y[500] - phi*y[499]
source('C:/Users/nesau/Desktop/residuals.R')
phi <- model$coef
phi
phi[1]
phi[1]+1
model
model$residuals
y[20] - phi*y[19]
y[19] - phi*y[18]
y[2] - phi*y[1]
y[1]
y[2] - phi*y[1]
y[1] - phi*1
y[1] - phi*mean(y)
y[1] - phi*y[20]
y[1] - phi*-1.09802093
phi*-1.09802093
model$residuals
y[20] - phi*y[19]
y[19] - phi*y[18]
y[1
]
setwd("C:/Users/nesau/stat485/")
library(TSA)
library(forecast)
copper <- read.csv("copper.csv", header = TRUE, sep=",")
names(copper) <- c("Year", "Price")
copperTS <- copper$Price
plot(copperTS, type = 'l')
acf(copperTS)
y <- diff(copperTS)
plot(y, type='l')
acf(y)
eacf(y)
auto.arima(y)
aicWN <- arima(y, order=c(0,0,0), include.mean=FALSE)$aic
aicARMA <- arima(y, order=c(2,0,1), include.mean=FALSE)$aic
source('C:/Users/nesau/stat485/analysis.R', echo=TRUE)
aicWN
aicARMA
arima(y, order=c(2,0,1), include.mean=FALSE)
arima(y, order=c(1,0,1), include.mean=FALSE)
arima(y, order=c(0,0,0), include.mean=FALSE)
model1<- arima(y, order=c(2,0,1), include.mean=FALSE)
css.phi1 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="CSS")$coef[1]
css.phi2 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="CSS")$coef[2]
css.theta1 <- -arima(y, order=c(2,0,1), include.mean=FALSE, method="CSS")$coef[3]
mle.phi1 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$coef[1]
mle.phi2 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$coef[2]
mle.theta1 <- -arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$coef[3]
css.sigma2 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="CSS")$sigma2
mle.sigma2 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$sigma2
ParameterEstimates <- data.frame(Method = c("CSS", "ML"),
Phi1 = c(css.phi1, mle.phi1),
Phi2 = c(css.phi2, mle.phi2),
Theta1 = c(css.theta1, mle.theta1),
Sigma2 = c( css.sigma2, mle.sigma2))
ParameterEstimates
output <- arima(y,order=c(2,0,1), include.mean=FALSE, method='ML')
output.summary <- summary(output)
confint(output)
residuals <- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$residuals
plot(residuals, type = 'l')
acf(residuals)
max(copperTS)
qqnorm(residuals, ylim=c(-5,5))
qqline(residuals) # residuals look ok
model<- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")
plot(forecast(model, h = 15))
plot(forecast(model, h = 15))
model<- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")
source('C:/Users/nesau/stat485/analysis.R')
plot(forecast(model, h = 15))
forecast(model, h = 15)
setwd("C:/Users/nesau/stat485/")
library(TSA)
library(forecast)
copper <- read.csv("copper.csv", header = TRUE, sep=",")
names(copper) <- c("Year", "Price")
copperTS <- copper$Price
plot(copperTS, type = 'l')
acf(copperTS)
y <- diff(copperTS)
plot(y, type='l')
acf(y)
eacf(y)
auto.arima(y)
aicWN <- arima(y, order=c(0,0,0), include.mean=FALSE)$aic
aicARMA <- arima(y, order=c(2,0,1), include.mean=FALSE)$aic
aicWN
aicARMA
arima(y, order=c(2,0,1), include.mean=FALSE)
arima(y, order=c(1,0,1), include.mean=FALSE)
arima(y, order=c(0,0,0), include.mean=FALSE)
model1 <- arima(y, order=c(2,0,1), include.mean=FALSE)
css.phi1 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="CSS")$coef[1]
css.phi2 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="CSS")$coef[2]
css.theta1 <- -arima(y, order=c(2,0,1), include.mean=FALSE, method="CSS")$coef[3]
mle.phi1 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$coef[1]
mle.phi2 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$coef[2]
mle.theta1 <- -arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$coef[3]
css.sigma2 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="CSS")$sigma2
mle.sigma2 <- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$sigma2
ParameterEstimates <- data.frame(Method = c("CSS", "ML"),
Phi1 = c(css.phi1, mle.phi1),
Phi2 = c(css.phi2, mle.phi2),
Theta1 = c(css.theta1, mle.theta1),
Sigma2 = c( css.sigma2, mle.sigma2))
ParameterEstimates
output <- arima(y,order=c(2,0,1), include.mean=FALSE, method='ML')
output <- arima(y, order=c(2,0,1), include.mean=FALSE, method='ML')
y
output.summary <- summary(output)
confint(output)
output <- arima(y, order=c(2,0,1), include.mean=FALSE, method='ML')
confint(output)
residuals <- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")$residuals
plot(residuals, type = 'l')
acf(residuals)
max(copperTS)
qqnorm(residuals, ylim=c(-5,5))
qqnorm(residuals, ylim=c(-5,5))
qqline(residuals) # residuals look ok
source('C:/Users/nesau/stat485/analysis.R', echo=TRUE)
model<- arima(y, order=c(2,0,1), include.mean=FALSE, method="ML")
plot(forecast(model, h = 15))
rm(list=ls())
source('C:/Users/nesau/stat485/analysis.R')
plot(forecast(model, h = 15))
source('C:/Users/nesau/stat485/statproj/project.R')
rm(list=ls())
options(warn=-1)
setwd("C:/Users/nesau/stat485/statproj/")
tradeDF <- read.csv("Bowley.csv", header=TRUE)
tradeTS <- tradeDF$Value
plot(tradeTS, type = 'l') # doesn't look stationary
y <- diff(tradeTS)
plot(y, type='l')
library(forecast)
auto.arima(y) # suggests MA(1) based on AIC
trade.ma <- arima(y, order=c(0,0,1), include.mean=FALSE)
trade.ar <- arima(y, order=c(1,0,0), include.mean=FALSE)
trade.arma <- arima(y, order=c(1,0,1), include.mean=FALSE)
ModelAIC <- data.frame(Model = c("MA", "AR", "ARMA"), AIC = c(trade.ma$aic, trade.ar$aic, trade.arma$aic))
ModelAIC
TSA::eacf(y)
acf(y)
pacf(y)
plot(y, type = 'l') # it looks like white noise
model <- arima(y, order = c(0,0,1), include.mean=FALSE)
r1 <- TSA::acf(y, plot=FALSE)$acf[1]
mom.theta <- (-1 + sqrt(1 - 4*r1^2))/(2*r1)
css.theta <- -arima(y, order=c(0,0,1), include.mean=FALSE, method="CSS")$coef
mle.theta <- -arima(y, order=c(0,0,1), include.mean=FALSE, method="ML")$coef
mom.sigma2 <- var(y)/(1+mom.theta^2)
css.sigma2 <- arima(y, order=c(0,0,1), include.mean=FALSE, method="CSS")$sigma2
mle.sigma2 <- arima(y, order=c(0,0,1), include.mean=FALSE, method="ML")$sigma2
ParameterEstimates <- data.frame(Method = c("Moments", "CSS", "ML"),
Theta = c(mom.theta, css.theta, mle.theta),
Sigma2 = c(mom.sigma2, css.sigma2, mle.sigma2))
theta <- mle.theta
sigma2 <- mle.sigma2
sigma <- sqrt(sigma2) # use this for simulation
residuals <- arima(y, order=c(0,0,1), include.mean=FALSE, method="ML")$residuals
plot(residuals, type = 'l')
acf(residuals)
qqnorm(residuals, ylim=c(-35, 35))
qqline(residuals) # residuals look ok
model <- arima(y, order=c(0,0,1), include.mean=FALSE, method="ML")
forecast(model, h = 15) # Project for 1900, 1901, ..., 1914
